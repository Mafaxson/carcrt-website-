import{c as P,r as d,j as e,X as D,u}from"./index-DG1zlAJv.js";import{a as I,L as q}from"./Layout-DSVRw__P.js";import{S as w}from"./section-header-Cbi5ry1I.js";import{C as b,a as j}from"./card-Du8RdagC.js";import{s as S}from"./supabaseClient-BRd1RTNM.js";import{B as E}from"./button-1bANESUZ.js";import{I as k}from"./input-C6uIeoFw.js";import{T as R}from"./textarea-XZ5hc_E4.js";import"./tslib.es6-Ds0fHAFP.js";import"./supabase-DIfPkhuc.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=P("Quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=P("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function T({onStorySubmit:v}){const[r,p]=d.useState({name:"",email:"",story:"",category:"General"}),[t,a]=d.useState(null),[N,g]=d.useState(""),[s,h]=d.useState(!1),i=d.useRef(null),l=n=>{const{name:o,value:m}=n.target;p(c=>({...c,[o]:m}))},f=n=>{var m;const o=(m=n.target.files)==null?void 0:m[0];if(o){if(o.size>5*1024*1024){u.error("Image size must be less than 5MB");return}if(!o.type.startsWith("image/")){u.error("Please upload an image file");return}a(o);const c=new FileReader;c.onloadend=()=>{g(c.result)},c.readAsDataURL(o)}},x=()=>{a(null),g(""),i.current&&(i.current.value="")},F=async n=>{if(n.preventDefault(),!r.name.trim()||!r.email.trim()||!r.story.trim()){u.error("Please fill in all fields");return}if(!t){u.error("Please upload an image with your story");return}h(!0);try{let o="";if(t){const c=t.name.split(".").pop(),A=`${r.name.replace(/\s+/g,"_")}_${Date.now()}.${c}`,{data:y,error:C}=await S.storage.from("story-images").upload(A,t,{upsert:!1});if(C)throw C;o=y!=null&&y.path?S.storage.from("story-images").getPublicUrl(y.path).data.publicUrl:""}const{error:m}=await S.from("submissions").insert([{type:"story",status:"pending",data:{name:r.name,email:r.email,story:r.story,category:r.category,imageUrl:o}}]);if(m)throw m;u.success("Story submitted successfully! Thank you for sharing your impact."),p({name:"",email:"",story:"",category:"General"}),x()}catch(o){console.error("Error:",o),u.error("Failed to submit story. Please try again.")}finally{h(!1)}};return e.jsx("section",{className:"section-padding bg-primary text-primary-foreground",children:e.jsx("div",{className:"container-custom",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"font-heading text-3xl md:text-4xl font-bold mb-4",children:"Share Your Story"}),e.jsx("p",{className:"text-lg text-primary-foreground/80",children:"Have you been impacted by CArCRT's programs? We'd love to hear your story and share it with others. Upload your photo and tell us how we've made a difference in your life."})]}),e.jsx(b,{className:"border-none shadow-lg bg-background",children:e.jsx(j,{className:"p-8",children:e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-foreground mb-2",children:"Your Name *"}),e.jsx(k,{id:"name",name:"name",type:"text",placeholder:"Enter your full name",value:r.name,onChange:l,className:"text-foreground",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-foreground mb-2",children:"Email Address *"}),e.jsx(k,{id:"email",name:"email",type:"email",placeholder:"your.email@example.com",value:r.email,onChange:l,className:"text-foreground",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-foreground mb-2",children:"Program Category"}),e.jsxs("select",{id:"category",name:"category",value:r.category,onChange:l,className:"w-full px-4 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"General",children:"General Impact"}),e.jsx("option",{value:"Drug Abuse Prevention",children:"Drug Abuse Prevention"}),e.jsx("option",{value:"Food Security & Women Empowerment",children:"Food Security & Women Empowerment"}),e.jsx("option",{value:"WASH",children:"WASH (Water, Sanitation & Hygiene)"}),e.jsx("option",{value:"Youth Development",children:"Youth Development"}),e.jsx("option",{value:"Community Health",children:"Community Health"}),e.jsx("option",{value:"Education",children:"Education"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"story",className:"block text-sm font-medium text-foreground mb-2",children:"Your Story *"}),e.jsx(R,{id:"story",name:"story",placeholder:"Tell us your story... (min 50 characters)",value:r.story,onChange:l,className:"text-foreground min-h-[150px]",required:!0}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[r.story.length," characters"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Upload Your Photo *"}),e.jsx("input",{ref:i,type:"file",accept:"image/*",onChange:f,className:"hidden"}),N?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:N,alt:"Preview",className:"w-full h-64 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:x,className:"absolute top-2 right-2 bg-destructive text-primary-foreground p-2 rounded-full hover:bg-destructive/90",children:e.jsx(D,{className:"h-4 w-4"})}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:t==null?void 0:t.name})]}):e.jsxs("button",{type:"button",onClick:()=>{var n;return(n=i.current)==null?void 0:n.click()},className:"w-full border-2 border-dashed border-primary/40 rounded-lg p-8 text-center hover:border-primary/60 transition-colors cursor-pointer",children:[e.jsx(H,{className:"h-8 w-8 text-primary/60 mx-auto mb-2"}),e.jsx("p",{className:"text-foreground font-medium",children:"Click to upload or drag and drop"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG, GIF up to 5MB"})]})]}),e.jsx(E,{type:"submit",disabled:s,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground font-medium py-2",children:s?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-2",children:"⏳"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Submit Your Story"]})}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"By submitting, you agree to allow CArCRT to share your story and photo on our website and promotional materials."})]})})})]})})})}const U=[{title:"From Risk to Resilience: Youth Transformation in Kenema",category:"Drug Abuse Prevention",summary:"A powerful story of a recovering youth who became a peer educator, now helping others overcome substance abuse challenges.",quote:"CArCRT gave me a second chance. Now I help others find their path to recovery and purpose.",author:"Youth Peer Educator, Kenema",image:"bg-gradient-to-br from-primary to-primary/70"},{title:"Women Farmers Leading Climate Adaptation",category:"Food Security & Women Empowerment",summary:"How our agriculture and livelihood empowerment programs have transformed women into community leaders in sustainable farming.",quote:"I learned new farming techniques that doubled my harvest. Now I train other women in my village.",author:"Women's Cooperative Leader, Eastern Province",image:"bg-gradient-to-br from-secondary to-secondary/70"},{title:"Clean Water, Healthy Communities",category:"WASH",summary:"The impact of our WASH projects in reducing waterborne diseases and improving community health outcomes.",quote:"Before the water point, our children were always sick. Now they're healthy and attending school regularly.",author:"Community Health Worker",image:"bg-gradient-to-br from-accent to-accent/70"}],L=[{quote:"CArCRT's programs have transformed our community. The youth are now engaged in productive activities instead of substance abuse.",author:"Community Chief, Kenema District"},{quote:"The training I received has given me the skills to support my family and contribute to my community.",author:"Program Beneficiary"},{quote:"Working with CArCRT has shown us what true community partnership looks like.",author:"Development Partner Representative"}];function J(){const[v,r]=d.useState([]);d.useEffect(()=>{(async()=>{try{const{data:a,error:N}=await supabase.from("submissions").select("*").eq("type","story").eq("status","approved").order("created_at",{ascending:!1});if(a){const g=a.map(s=>{var h,i,l,f,x;return{id:s.id,name:((h=s.data)==null?void 0:h.name)||"Anonymous",email:((i=s.data)==null?void 0:i.email)||"",story:((l=s.data)==null?void 0:l.story)||"",category:((f=s.data)==null?void 0:f.category)||"General",imagePreview:((x=s.data)==null?void 0:x.imageUrl)||"",timestamp:new Date(s.created_at)}});r(g)}}catch(a){console.error("Failed to fetch stories:",a)}})()},[]);const p=t=>{r(a=>[t,...a])};return e.jsxs(q,{children:[e.jsx("section",{className:"relative py-20 bg-gradient-hero",children:e.jsx("div",{className:"container-custom",children:e.jsxs("div",{className:"max-w-3xl mx-auto text-center animate-fade-up",children:[e.jsx("h1",{className:"font-heading text-4xl md:text-5xl font-bold text-foreground mb-6",children:e.jsx("span",{className:"gradient-text",children:"Impact Stories"})}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Real stories of transformation and resilience from communities across Sierra Leone"})]})})}),e.jsx("section",{className:"section-padding bg-background",children:e.jsxs("div",{className:"container-custom",children:[e.jsx(w,{title:"Featured Stories",subtitle:"Discover how our programs are making a difference"}),e.jsx("div",{className:"grid gap-8",children:U.map((t,a)=>e.jsx(b,{className:"overflow-hidden border-none shadow-card animate-fade-up",style:{animationDelay:`${a*100}ms`},children:e.jsx(j,{className:"p-0",children:e.jsxs("div",{className:"grid md:grid-cols-2",children:[e.jsxs("div",{className:`${t.image} p-8 md:p-12 text-primary-foreground min-h-[300px] flex flex-col justify-end`,children:[e.jsx("span",{className:"text-sm font-medium opacity-80 mb-2",children:t.category}),e.jsx("h3",{className:"font-heading text-2xl font-bold",children:t.title})]}),e.jsxs("div",{className:"p-8 md:p-12 flex flex-col justify-center",children:[e.jsx("p",{className:"text-muted-foreground mb-6",children:t.summary}),e.jsx("blockquote",{className:"border-l-4 border-primary pl-4 mb-4",children:e.jsxs("p",{className:"text-foreground italic",children:['"',t.quote,'"']})}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["— ",t.author]})]})]})})},a))})]})}),e.jsx("section",{className:"section-padding bg-muted",children:e.jsxs("div",{className:"container-custom",children:[e.jsx(w,{title:"Voices from the Community",subtitle:"Hear what our beneficiaries and partners have to say"}),e.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:L.map((t,a)=>e.jsx(b,{className:"card-hover border-none shadow-card animate-fade-up",style:{animationDelay:`${a*100}ms`},children:e.jsxs(j,{className:"p-6",children:[e.jsx(W,{className:"h-8 w-8 text-primary/30 mb-4"}),e.jsxs("p",{className:"text-foreground italic mb-4",children:['"',t.quote,'"']}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["— ",t.author]})]})},a))})]})}),v.length>0&&e.jsx("section",{className:"section-padding bg-background",children:e.jsxs("div",{className:"container-custom",children:[e.jsx(w,{title:"Recently Shared Stories",subtitle:"Stories just shared by our community members"}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map(t=>e.jsx(b,{className:"overflow-hidden border-none shadow-card card-hover animate-fade-up h-full flex flex-col",children:e.jsxs(j,{className:"p-0 flex flex-col h-full",children:[t.imagePreview&&e.jsx("img",{src:t.imagePreview,alt:t.name,className:"w-full h-72 object-cover object-center flex-shrink-0"}),e.jsxs("div",{className:"p-6 flex-grow flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"inline-block text-xs font-semibold text-primary bg-primary/10 px-3 py-1 rounded-full mb-3",children:t.category}),e.jsxs("h3",{className:"font-heading text-lg font-bold text-foreground mb-3",children:[t.name,"'s Story"]}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4 line-clamp-4",children:t.story})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Shared ",new Date(t.timestamp).toLocaleDateString()]})]})]})},t.id))})]})}),e.jsx(T,{onStorySubmit:p})]})}export{J as default};
